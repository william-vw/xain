# @alsoload ../test/yellow-rules.n3

@prefix e: <http://eulersharp.sourceforge.net/2003/03swap/log-rules#> .
@prefix list: <http://www.w3.org/2000/10/swap/list#> .
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix string: <http://www.w3.org/2000/10/swap/string#> .
@prefix x: <http://wvw.org/xai#> .
@prefix : <http://niche.cs.dal.ca/ns/copd.owl#> .


{
   ?x => ?y ; a x:InputRule .
   "x" log:trace ?x .
   ?x!e:labelvars x:get ?x2 .
   ?y!e:labelvars x:get ?y2 .
   "x2" log:trace ( ?y2 ?x2 ) .
}
=> 
{
   ?y2 => ?x2
} .


#
{
   ?f x:get ?f2 
}
<= 
{
   ?f log:rawType log:Formula .
   (
       {
           ?s2 ?p2 ?o2 
       }
       {
           ?f e:graphMember 
           {
               ?s ?p ?o 
           } .
           ?s x:get ?s2 .
           ?p x:get ?p2 .
           ?o x:get ?o2 .
       }
       ?rws
   ) log:collectAllIn _:t .
   ?rws log:conjunction ?f2 .
   "T0" log:trace ( ?f2 ) .
   # ( "!" ) e:derive true 
} .


#
{
   ?c x:get ?c2 
}
<= 
{
   ?c log:rawType log:List .
   (
       ?e2
       {
           ?c!list:member x:get ?e2 
       }
       ?c2
   ) log:collectAllIn _:t .
   "T0.5" log:trace ( ?c2 ) .
   # ( "!" ) e:derive true 
} .


#
{
   ?t x:get ?t2 
}
<= 
{
   ?t log:rawType log:Other .
   ?t log:uri ?tStr .
   ?tStr string:matches "http://www.w3.org/2000/10/swap/.*" .
   ( ?tStr "http://www.w3.org/2000/10/swap/" "http://wvw.org/xai/swap/" ) string:replace ?tStr2 .
   ?t2 log:uri ?tStr2 .
   "T2" log:trace ( ?t2 ) .
   # ( "!" ) e:derive true 
} .


#
{
   ?t x:get ?t 
}
<= 
{
   ?t log:rawType log:Other .
   ?t!log:uri string:notMatches "http://www.w3.org/2000/10/swap/.*" .
   "T3" log:trace ( ?t ) .
   # ( "!" ) e:derive true 
} .


#
{
   ?t x:get ?t 
}
<= 
{
   ?t log:rawType log:Literal .
   "T4" log:trace ( ?t ) .
   # ( "!" ) e:derive true 
} .
